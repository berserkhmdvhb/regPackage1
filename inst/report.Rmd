---
title: "Car Insurance Claims Dataset Classification - Report"
author: "Hamed Vaheb"
#1date: "09 Jan 2021"
output:
  html_document:
    number_sections: yes
    toc: yes
    code_folding: hide
    theme: readable
    highlight: haddock
  pdf_document:
    toc: yes
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(regPackage1)
library(dplyr)
library(janitor)
library(caret)
library(tidymodels)
```
# Introduction
This report is dedicated to project of a workshop of master of data science at University of Luxembourg, I built the [`regPackage1`](https://github.com/berserkhmdvhb/regPackage1). 
You can install this package by first installing the [devtools](https://www.r-project.org/nosvn/pandoc/devtools.html) package and then using the following syntax:

`devtools::install_github("https://github.com/berserkhmdvhb/regPackage1")`

You can explore the documentation of package I provided with 

`help(package="regPackage1")`

Also, this report is accessible as vignette of the package, which can be accessed with

`vignette(package = "regPackage1")`

(Note: I just made a meta-reference)


## Import Data
To provide a test case on a dataset with discrete target variable, I used the the [car insurance data](https://www.kaggle.com/datasets/sagnik1511/car-insurance-data).
I incorporated this dataset in the package. It can be used by the following syntax:

`data(car_insurance_data)`




```{r}
data(car_insurance_data)

dplyr::glimpse(car_insurance_data)
```


Summary of statistical properties of columns are provided in the following:

```{r}
summary(car_insurance_data)
```



 
## Load Dataset

As main focus on a dataset with continous target, the dataset used for this package is [Medical Cost Personal Datasets](https://www.kaggle.com/datasets/mirichoi0218/insurance).
In order to be familiarized with the dataset, after loading the `regPackage1` package, run `?insurance_data`.

The dataset is embedded in the package, therefore by simply running the following commands one can load and display the dataset.

```{r}
data(car_insurance_data)
dplyr::glimpse(car_insurance_data)
summary(car_insurance_data)
```
Note that all functions of the package are suffixed with `hmd`.

# Preprocess

## Categorical Columns
Before feeding to model, we need to factorise the categorical columns, which can be done by merely inputting columns intended to be converted in `cat_cols` in the `prepare_hmd` function.

```{r}
insurance_data_cleaned <- prepare_hmd(car_insurance_data)
dplyr::glimpse(insurance_data_cleaned)
```


## Categorical Columns

## Classification Models
#### Generalized Linear Model (GLM)
Let us see the result of applying GLM on the target variable, which is `outcome`. 
For this, I wrote the function [glm_hmd](https://github.com/berserkhmdvhb/regPackage1/blob/main/R/glm_hmd.R).

Since the target variable is binary, and the goal is classification, adiscrete distribution, e.g., poisson is used, and also check if normalization of response variables would have any significant effect:

**Poisson**


1. Without Normalize

```{r}
glm_hmd(insurance_data_cleaned, target="outcome", family=poisson)
```

2. With Normalize

```{r}
#glm_hmd(insurance_data_cleaned, target="charges", family=gaussian, normalize=TRUE)
```

**Gamma**



1. Without Normalize
```{r}
#glm_hmd(insurance_data_cleaned, target="charges", family=Gamma)
```

### With Normalize
```{r}
#glm_hmd(insurance_data_cleaned, target="charges", family=Gamma, normalize=TRUE)
```          

